!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@zxing/library")):"function"==typeof define&&define.amd?define(["@zxing/library"],t):(e||self).BarcodeDetectorPolyfill=t(e.ZXing)}(this,function(e){function t(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,t}var r=t(e);function n(e,t,r){var n=document.createElement("canvas"),a=n.getContext("2d");return n.width=t,n.height=r,a.drawImage(e,0,0,t,r),a.getImageData(0,0,t,r)}var a=function(e){try{if(e instanceof HTMLImageElement){try{e.decode()}catch(e){throw new DOMException("HTMLImageElement is not decodable","InvalidStateError")}return Promise.resolve(n(e,e.naturalWidth,e.naturalHeight))}if(e instanceof SVGImageElement)return Promise.resolve(n(e,640,480));if(e instanceof HTMLVideoElement){if(0===e.readyState||1===e.readyState)throw new DOMException("","InvalidStateError");return Promise.resolve(n(e,e.videoWidth,e.videoHeight))}if(e instanceof HTMLCanvasElement){var t=e.getContext("2d");return Promise.resolve(t.getImageData(0,0,e.width,e.height))}if("ImageBitmap"in window&&e instanceof ImageBitmap)return Promise.resolve(n(e,e.width,e.height));if("OffscreenCanvas"in window&&e instanceof OffscreenCanvas){var r=e.getContext("2d");return Promise.resolve(r.getImageData(0,0,e.width,e.height))}return e instanceof Blob?Promise.resolve(o(e)):e instanceof ImageData?Promise.resolve(e):Promise.resolve()}catch(e){return Promise.reject(e)}},o=function(e){try{var t=URL.createObjectURL(e),r=new Image;return r.src=t,Promise.resolve(new Promise(function(e,t){r.onload=e,r.onerror=t})).then(function(){return URL.revokeObjectURL(t),a(r)})}catch(e){return Promise.reject(e)}},i=new Map([["aztec",r.BarcodeFormat.AZTEC],["code_39",r.BarcodeFormat.CODE_39],["code_128",r.BarcodeFormat.CODE_128],["data_matrix",r.BarcodeFormat.DATA_MATRIX],["ean_8",r.BarcodeFormat.EAN_8],["ean_13",r.BarcodeFormat.EAN_13],["itf",r.BarcodeFormat.ITF],["pdf417",r.BarcodeFormat.PDF_417],["qr_code",r.BarcodeFormat.QR_CODE],["upc_a",r.BarcodeFormat.UPC_A],["upc_e",r.BarcodeFormat.UPC_E]]),c=new Map(Array.from(i).map(function(e){return[e[1],e[0]]})),d=Array.from(i.keys()),u=function(e){var t=c.get(e.getBarcodeFormat()),r=e.getText(),n=Object.freeze(e.getResultPoints().map(function(e){return{x:e.getX(),y:e.getY()}})),a=n.map(function(e){return e.x}),o=n.map(function(e){return e.y}),i=Math.min.apply(Math,a),d=Math.max.apply(Math,a),u=Math.min.apply(Math,o),m=Math.max.apply(Math,o);return{format:t,rawValue:r,cornerPoints:n,boundingBox:DOMRectReadOnly.fromRect({x:i,y:u,width:d-i,height:m-u})}};return function(){function e(e){var t;this.reader=void 0;var n=null!=(t=null==e?void 0:e.formats)?t:d;if(0===n.length)throw new TypeError("");if(n.includes("unknown"))throw new TypeError("");var a=new Map([[r.DecodeHintType.POSSIBLE_FORMATS,n.map(function(e){return i.get(e)})]]);this.reader=new r.MultiFormatReader,this.reader.setHints(a)}return e.getSupportedFormats=function(){return Promise.resolve(d)},e.prototype.detect=function(e){try{var t=this;return Promise.resolve(a(e)).then(function(e){var n=document.createElement("canvas"),a=n.getContext("2d");n.width=e.width,n.height=e.height,a.putImageData(e,0,0);try{var o=new r.HTMLCanvasElementLuminanceSource(n),i=new r.BinaryBitmap(new r.HybridBinarizer(o)),c=t.reader.decode(i);return[u(c)]}catch(e){return console.error(e),[]}})}catch(e){return Promise.reject(e)}},e}()});
//# sourceMappingURL=barcode-detector.umd.js.map
